<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Mappa GTA V</title>

<link rel="stylesheet"
      href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
}

#map {
  height: 100vh;
  width: 100vw;
}

.popup-grande {
  width: 260px;
  text-align: center;
  font-family: sans-serif;
}

/*  SLIDER  */

.slider {
  position: relative;
  width: 100%;
  height: 220px;
  overflow: hidden;
}

.slide {
  position: absolute;
  width: 100%;
  opacity: 0;
  transition: opacity 0.3s ease;
  text-align: center;
}

.slide img {
  width: 100%;
  height: 160px;
  object-fit: cover;
  border-radius: 12px;
}

.slide.active {
  opacity: 1;
}

.nome {
  margin-top: 6px;
  font-weight: bold;
}

.prev, .next {
  position: absolute;
  top: 70px;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.6);
  color: white;
  border: none;
  padding: 5px 8px;
  cursor: pointer;
  border-radius: 6px;
  font-size: 14px;
}

.prev { left: 5px; }
.next { right: 5px; }

.prev:hover, .next:hover {
  background: rgba(0,0,0,0.85);
}

      .no-crop {
  object-fit: contain !important;
  background: #000;
}
</style>
</head>

<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>

// MAPPA

var map = L.map('map', {
  crs: L.CRS.Simple,
  zoomControl: true,
  minZoom: -10,
  maxZoom: 5
});

var imageHeight = 9216;
var imageWidth = 6144;

var bounds = [[0, 0], [imageHeight, imageWidth]];

L.imageOverlay('mappa2_upscayl_2x_high-fidelity-4x.webp', bounds).addTo(map);

var containerHeight = map.getContainer().clientHeight;
var zoom = Math.log2(containerHeight / imageHeight);

map.setView([imageHeight / 2, imageWidth / 2], zoom);
map.setMaxBounds(bounds);


// ICONA

var violetIcon = new L.Icon({
  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png',
  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});


// MARKER + SLIDE

L.marker([2170,2897], { icon: violetIcon }).addTo(map)
.bindPopup(`
<div class="popup-grande">
<h3>Civ.123</h3>

<div class="slider">

  <div class="slide active">
    <img src="Immagini/Screenshot 2026-02-16 094906.png">
    <div class="nome">ðŸ‘¤ Ryu Shezen</div>
  </div>

  <div class="slide">
    <img src="Immagini/Screenshot 2026-02-16 094913.png">
    <div class="nome">ðŸ‘¤ Franky West</div>
  </div>

  <div class="slide">
    <img src="Immagini/Screenshot 2026-02-16 094922.png">
    <div class="nome">ðŸ‘¤ Wei Shaofeng</div>
  </div>

  <div class="slide">
    <img src="Immagini/Screenshot 2026-02-16 094934.png">
    <div class="nome">ðŸ‘¤ Marcus Lee</div>
  </div>

  <div class="slide">
    <img src="Immagini/Screenshot 2026-02-16 094942.png">
    <div class="nome">ðŸ‘¤ Johnny Lee</div>
  </div>

  <div class="slide">
    <img src="Immagini/Screenshot 2026-02-16 094949.png">
    <div class="nome">ðŸ‘¤ Morgan Draymoor</div>
  </div>

  <div class="slide">
      <img src="immagini/Screenshot 2026-02-16 095000.png" class="no-crop">
      <div class="nome">ðŸ‘¤ Franklin Black</div>
  </div>

  <div class="slide">
    <img src="Immagini/Screenshot 2026-02-16 095010.png">
    <div class="nome">ðŸ‘¤ Mei Ling Zhou</div>
  </div>

  <button class="prev">â—€</button>
  <button class="next">â–¶</button>

</div>
</div>
`, {
  maxWidth: 260,
  minWidth: 260
});


// SLIDER

map.on('popupopen', function () {
  const sliders = document.querySelectorAll('.slider');

  sliders.forEach(slider => {
    let slides = slider.querySelectorAll('.slide');
    let current = 0;

    const showSlide = (index) => {
      slides.forEach(s => s.classList.remove('active'));
      slides[index].classList.add('active');
    };

    slider.querySelector('.next').onclick = () => {
      current = (current + 1) % slides.length;
      showSlide(current);
    };

    slider.querySelector('.prev').onclick = () => {
      current = (current - 1 + slides.length) % slides.length;
      showSlide(current);
    };

    showSlide(current);
  });
});

</script>

</body>
</html>
